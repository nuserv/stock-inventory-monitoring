var r=1,c=1,y=1,b=1;$(document).ready(function(){var a=$("table.stockTable").DataTable({dom:"lrtip",language:{emptyTable:" "},processing:!0,serverSide:!0,ajax:"show",columns:[{data:"category",name:"category"},{data:"description",name:"description"},{data:"quantity",name:"quantity"}]});$("#search-ic").on("click",function(d){for(d=0;6>=d;d++)$(".fl-"+d).val("").change(),a.columns(d).search("").draw();$(".tbsearch").toggle()});$(".filter-input").keyup(function(){a.column($(this).data("column")).search($(this).val()).draw()})});
$(document).on("click","#addStockBtn",function(){$("#addModal").modal({backdrop:"static",keyboard:!1})});$(document).on("change",".item",function(){var a=$(this).attr("row_count"),d=$(this).val();$("#desc"+a).val(d)});$(document).on("change",".desc",function(){var a=$(this).attr("row_count"),d=$(this).val();$("#item"+a).val(d)});
$(document).on("change",".category",function(){var a=" ",d=" ",e=$(this).attr("row_count"),f=$(this).val();(function(k){$.ajax({type:"get",url:"itemcode",data:{id:f},success:function(h){a+='<option selected value="select" disabled>select item code</option>';d+='<option selected value="select" disabled>select description</option>';for(var g=0;g<h.length;g++)a+='<option value="'+h[g].id+'">'+h[g].id+"</option>",d+='<option value="'+h[g].id+'">'+h[g].item.toUpperCase()+"</option>";$("#item"+e).find("option").remove().end().append(a);
$("#desc"+e).find("option").remove().end().append(d)}})})(item1);$("#item"+e).val("select itemcode");$("#desc"+e).val("select description")});
$(document).on("click",".add_item",function(){var a=$(this).attr("btn_id");if("Add Item"==$(this).val()){if($("#category"+a).val()&&$("#item"+a).val()&&$("#desc"+a).val()){y++;var d='<div class="row no-margin" id="row'+y+'"><div class="col-md-2 form-group"><select id="category'+y+'" class="form-control category" row_count="'+y+'"></select></div><div class="col-md-2 form-group"><select id="item'+y+'" class="form-control item" row_count="'+y+'"><option selected disabled>select item code</option></select></div><div class="col-md-3 form-group"><select id="desc'+
y+'" class="form-control desc" row_count="'+y+'"><option selected disabled>select description</option></select></div><div class="col-md-1 form-group"><input type="button" class="add_item btn btn-xs btn-primary" btn_id="'+y+'" value="Add Item"></div></div>';$(this).val("Remove");$("#category"+a).prop("disabled",!0);$("#item"+a).prop("disabled",!0);$("#desc"+a).prop("disabled",!0);20>r&&($("#reqfield").append(d),$("#category"+a).find("option").clone().appendTo("#category"+y),r++)}}else 20==r&&(y++,
d='<div class="row no-margin" id="row'+y+'"><div class="col-md-2 form-group"><select id="category'+y+'" class="form-control category" row_count="'+y+'"></select></div><div class="col-md-2 form-group"><select id="item'+y+'" class="form-control item" row_count="'+y+'"><option selected disabled>select item code</option></select></div><div class="col-md-3 form-group"><select id="desc'+y+'" class="form-control desc" row_count="'+y+'"><option selected disabled>select description</option></select></div><div class="col-md-1 form-group"><input type="button" class="add_item btn btn-xs btn-primary" btn_id="'+
y+'" value="Add Item"></div></div>',$("#reqfield").append(d),$("#category"+a).find("option").clone().appendTo("#category"+y),r++),$("#category"+a).val("select category"),$("#item"+a).val("select item code"),$("#desc"+a).val("select description"),$("#category"+a).prop("disabled",!1),$("#item"+a).prop("disabled",!1),$("#desc"+a).prop("disabled",!1),$("#row"+a).hide(),$(this).val("Add Item"),r--});
$(document).on("click",".sub_Btn",function(){for(var a,d,e=1,f=1;f<=y;f++)$("#row"+f).is(":visible")&&"Remove"==$(".add_item[btn_id='"+f+"']").val()&&(e++,$(".sub_Btn").prop("disabled",!0),a=$("#category"+f).val(),d=$("#item"+f).val(),$.ajax({url:"store",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"json",type:"POST",data:{item:d,cat:a}}));1<e&&(alert("Inventory updated!!!"),window.location.href="stocks")});
$(document).on("click","#addCatBtn",function(){$("#addModal .close").click();$("#categoryModal").modal({backdrop:"static",keyboard:!1})});$(document).on("click","#addCodeBtn",function(){$("#addModal .close").click();$("#itemModal").modal({backdrop:"static",keyboard:!1})});
$(document).on("click",".add_cat",function(){var a=$(this).attr("btn_id");console.log("1");if("Add"==$(this).val()){console.log("2");if($("#cat"+a).val()){y++;var d='<div class="row no-margin" id="catrow'+y+'"><div class="col-md-8 form-group"><input type="text" id="cat'+y+'" class="form-control serial" row_count="'+y+'" placeholder="Category"></div><div class="col-md-1 form-group"><input type="button" class="add_cat btn btn-xs btn-primary" btn_id="'+y+'" value="Add"></div></div>';$(this).val("Remove");
$("#cat"+a).prop("disabled",!0);console.log("3");console.log("test"+y)}10>c&&($("#catfield").append(d),$("#cat"+a).find("option").clone().appendTo("#cat"+y),c++,console.log("4"))}else console.log("5"),10==c&&(y++,d='<div class="row no-margin" id="catrow'+y+'"><div class="col-md-8 form-group"><input type="text" id="cat'+y+'" class="form-control serial" row_count="'+y+'" placeholder="Category"></div><div class="col-md-1 form-group"><input type="button" class="add_cat btn btn-xs btn-primary" btn_id="'+
y+'" value="Add"></div></div>',$("#catfield").append(d),$("#cat"+a).find("option").clone().appendTo("#cat"+y),console.log("6"),c++),$("#cat"+a).val(""),$("#catrow"+a).hide(),$(this).val("Add"),c--});
$(document).on("click",".add_item-desc",function(){var a=$(this).attr("btn_id");console.log("1");if("Add"==$(this).val()){console.log("2");if($("#item-desc"+a).val()&&$("#itemcat"+a).val()){y++;var d='<div class="row no-margin" id="itemrow'+y+'"><div class="col-md-4 form-group"><select id="itemcat'+y+'" class="form-control item-category" row_count="'+y+'"></select></div><div class="col-md-4"><input type="text" id="item-desc'+y+'" class="form-control" row_count="'+y+'" placeholder="Item Description"></div><div class="col-md-1 form-group"><input type="button" class="add_item-desc btn btn-xs btn-primary" btn_id="'+
y+'" value="Add"></div></div>';$(this).val("Remove");$("#item-desc"+a).prop("disabled",!0);$("#itemcat"+a).prop("disabled",!0);console.log("3")}10>b&&($("#itemfield").append(d),$("#itemcat"+a).find("option").clone().appendTo("#itemcat"+y),b++,console.log("4"))}else console.log("5"),10==b&&(y++,d='<div class="row no-margin" id="itemrow'+y+'"><div class="col-md-4 form-group"><select id="itemcat'+y+'" class="form-control item-category" row_count="'+y+'"></select></div><div class="col-md-4"><input type="text" id="item-desc'+
y+'" class="form-control" row_count="'+y+'" placeholder="Item Description"></div><div class="col-md-1 form-group"><input type="button" class="add_item-desc btn btn-xs btn-primary" btn_id="'+y+'" value="Add"></div></div>',$("#itemfield").append(d),$("#itemcat"+a).find("option").clone().appendTo("#itemcat"+y),console.log("6"),b++),$("#itemcat"+a).val(""),$("#itemrow"+a).hide(),$(this).val("Add"),b--});
$(document).on("click","#sub_cat_Btn",function(){for(var a,d=1,e=1;e<=y;e++)$("#catrow"+e).is(":visible")&&"Remove"==$(".add_cat[btn_id='"+e+"']").val()&&(d++,$("#sub_cat_Btn").prop("disabled",!0),a=$("#cat"+e).val(),$.ajax({url:"addcategory",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"json",type:"POST",data:{cat:a}}));1<d&&(alert("Category added!!!"),window.location.href="stocks")});
$(document).on("click","#sub_item_Btn",function(){var a=1;console.log(y);for(var d=1;d<=y;d++)if($("#itemrow"+d).is(":visible")&&(console.log(y),"Remove"==$(".add_item-desc[btn_id='"+d+"']").val())){a++;$("#sub_item_Btn").prop("disabled",!0);var e=$("#itemcat"+d).val();item=$("#item-desc"+d).val();$.ajax({url:"additem",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"json",type:"POST",data:{cat:e,item:item}})}1<a&&(alert("Item added!!!"),window.location.href="stocks")});
$(document).on("click",".cancel",function(){window.location.href="stocks"});$(document).on("click","#importBtn",function(){$("#importModal").modal({backdrop:"static",keyboard:!1})});