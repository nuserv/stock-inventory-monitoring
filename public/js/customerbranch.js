var table,bID;
$(document).ready(function(){var a=window.location.pathname;bID=a=a.substring(a.lastIndexOf("/")+1);table=$("table.customerbranchTable").DataTable({dom:"lrtip",language:{emptyTable:" "},processing:!0,serverSide:!0,ajax:"/customerbranch-list/"+a,columns:[{data:"code",name:"code"},{data:"customer_branch",name:"customer_branch"},{data:"contact",name:"contact"},{data:"status",name:"status"}]});$("#search-ic").on("click",function(b){for(b=0;3>=b;b++)$(".fl-"+b).val("").change(),
table.columns(b).search("").draw();$(".tbsearch").toggle()});$(".filter-input").keyup(function(){table.column($(this).data("column")).search($(this).val()).draw()});$("#branchBtn").val('ADD "'+$("#name").val()+'" BRANCH')});
$(document).on("click","#customerbranchTable tr",function(){var a=table.row(this).data(),b=a.id;$("#saveBtn").val("Update");$("#myid").val(b);$("#branch_code").val(a.code);$("#branch_name").val(a.customer_branch);$("#address").val(a.address);$("#number").val(a.contact);$(".status").show();"Active"==a.status?$("#status").val("1"):$("#status").val("0");$("#customerbranchModal").modal("show")});
$("#branchBtn").on("click",function(){$("#saveBtn").val("Save");$("#branch_code").val("");$("#branch_name").val("");$("#number").val("");$("#address").val("");$("#subBtn").val("Save");$("#myid").val(bID);$(".status").hide();$("#customerbranchModal").modal("show")});
$(document).on("click","#saveBtn",function(a){a.preventDefault();var b=$("#saveBtn").val();a=$("#branch_code").val();var d=$("#branch_name").val(),e=$("#number").val(),f=$("#address").val(),g=bID,h=$("#myid").val();"Save"==b&&$.ajax({type:"POST",url:"../cbranch_add",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{bcode:a,bname:d,number:e,address:f,bid:g},success:function(c){"0"<c?(table.draw(),$("#customerbranchModal .close").click()):alert("Branch already registered")},
error:function(c,k,l){alert(c.responseText)}});"Update"==b&&(b=$("#status").val(),$.ajax({type:"Put",url:"../cbranch_update",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{bcode:a,bname:d,number:e,address:f,status:b,id:h,bid:g},success:function(c){"0"<c?(table.draw(),$("#customerbranchModal .close").click()):alert("Branch already registered")},error:function(c,k,l){alert(c.responseText)}}))});