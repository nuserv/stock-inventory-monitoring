var replaceTable,repdata;$(document).on("click",".replacement",function(){$("#outOptionModal .close").click();$("#replacementModal").modal({backdrop:"static",keyboard:!1})});
$(document).on("change",".replacementdesc",function(){var a=$(this).attr("row_count"),b=$(this).val(),e=" ";$("#replacementserial"+a).val("select serial");$.ajax({type:"get",url:"getserials",data:{id:b},async:!1,success:function(d){e+='<option selected value="select" disabled>select serial</option>';for(var c=0;c<d.length;c++)e+='<option value="'+d[c].serial+'">'+d[c].serial+"</option>";$("#replacementserial"+a).find("option").remove().end().append(e)}})});
$(document).on("click",".service-unit",function(){$("#outOptionModal .close").click();$("#service-unitModal").modal({backdrop:"static",keyboard:!1})});
$(document).on("click",".out_sub_Btn",function(){var a=1;if(""!=$("#customer-id").val()){console.log(1);for(var b=1;b<=y;b++)if($("#outrow"+b).is(":visible")&&"Remove"==$(".out_add_item[btn_id='"+b+"']").val()){a++;console.log(2);$(".out_sub_Btn").prop("disabled",!0);var e=$("#outcategory"+b).val();var d=$("#outdesc"+b).val();serial=$("#outserial"+b).val();purpose="service unit";client=$("#client-id").val();customer=$("#customer-id").val();$.ajax({url:"service-out",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},
dataType:"json",type:"PUT",data:{item:d,serial:serial,cat:e,purpose:purpose,customer:customer,client:client}})}}else return alert("Invalid Customer Name!!!!"),!1;1<a&&(console.log(3),window.location.href="stocks")});
$(document).on("change",".outdesc",function(){for(var a=$(this).attr("row_count"),b=$(this).val(),e=0,d=" ",c=1;c<=y;c++)c!=a&&$("#outdesc"+c).val()==$(this).val()&&e++;(function(f){$.ajax({type:"get",url:"getstock",data:{id:b},async:!1,success:function(g){""!=g?($("#outstock"+a).val(g[0].stock-e),$("#outstock"+a).css("color","black"),$("#outstock"+a).css("border",""),0>=$("#outstock"+a).val()&&($("#outstock"+a).css("color","red"),$("#outstock"+a).css("border","5px solid red"))):($("#outstock"+a).val("0"),
$("#outstock"+a).css("color","red"),$("#outstock"+a).css("border","5px solid red"))}});$.ajax({type:"get",url:"getserials",data:{id:b},async:!1,success:function(g){d+='<option selected value="select" disabled>select serial</option>';for(var h=0;h<g.length;h++)d+='<option value="'+g[h].serial+'">'+g[h].serial+"</option>";$("#outserial"+a).find("option").remove().end().append(d)}})})(outstock1);for(c=1;c<=y;c++)$("#outdesc"+c).val()==$(this).val()&&(rmserial=$("#outserial"+c).val(),$("#outserial"+a+
" option[value='"+rmserial+"']").remove())});$(document).on("change",".outcategory",function(){var a=" ",b=$(this).attr("row_count"),e=$(this).val();(function(d){$.ajax({type:"get",url:"itemcode",data:{id:e},success:function(c){a+='<option selected value="select" disabled>select description</option>';for(var f=0;f<c.length;f++)a+='<option value="'+c[f].id+'">'+c[f].item.toUpperCase()+"</option>";$("#outdesc"+b).find("option").remove().end().append(a)}})})(outdesc1);$("#outdesc"+b).val("select description")});
$(document).on("change",".outitem",function(){var a=$(this).attr("row_count"),b=$(this).val();$("#outdesc"+a).val(b)});
$(document).on("click",".out_add_item",function(){var a=$(this).attr("btn_id");if("Add Item"==$(this).val()){if($("#outcategory"+a).val()&&$("#outdesc"+a).val()&&$("#outserial"+a).val()){y++;var b='<div class="row no-margin" id="outrow'+y+'"><div class="col-md-2 form-group"><select style="color:black" id="outcategory'+y+'" class="form-control outcategory" row_count="'+y+'"></select></div><div class="col-md-3 form-group"><select style="color:black" id="outdesc'+y+'" class="form-control outdesc" row_count="'+
y+'"><option selected disabled>select description</option></select></div><div class="col-md-2 form-group"><select id="outserial'+y+'" class="form-control outserial" row_count="'+y+'" style="color: black;"><option selected disabled>select serial</option></select></div><div class="col-md-1 form-group"><input type="number" class="form-control" min="0" name="outstock'+y+'" id="outstock'+y+'" placeholder="0" style="color:black; width: 6em" disabled></div><div class="col-md-1 form-group"><input type="button" class="out_add_item btn btn-xs btn-primary" btn_id="'+
y+'" value="Add Item"></div></div>';$(this).val("Remove");$("#outcategory"+a).prop("disabled",!0);$("#outdesc"+a).prop("disabled",!0);$("#outserial"+a).prop("disabled",!0);20>r&&($("#outfield").append(b),$("#outcategory"+a).find("option").clone().appendTo("#outcategory"+y),r++)}}else 20==r&&(y++,b='<div class="row no-margin" id="outrow'+y+'"><div class="col-md-2 form-group"><select id="outcategory'+y+'" class="form-control outcategory" row_count="'+y+'"></select></div><div class="col-md-3 form-group"><select id="outdesc'+
y+'" class="form-control outdesc" row_count="'+y+'"><option selected disabled>select description</option></select></div><div class="col-md-2 form-group"><select id="outserial'+y+'" class="form-control outserial" row_count="'+y+'" style="color: black;"><option selected disabled>select serial</option></select></div><div class="col-md-1 form-group"><input type="number" class="form-control" min="0" name="outstock'+y+'" id="outstock'+y+'" placeholder="0" style="color:black; width: 6em" disabled></div><div class="col-md-1 form-group"><input type="button" class="out_add_item btn btn-xs btn-primary" btn_id="'+
y+'" value="Add Item"></div></div>',$("#outfield").append(b),$("#outcategory"+a).find("option").clone().appendTo("#outcategory"+y),r++),$("#outcategory"+a).val("select category"),$("#outdesc"+a).val("select description"),$("#outserial"+a).val("select serial"),$("#outcategory"+a).prop("disabled",!1),$("#outdesc"+a).prop("disabled",!1),$("#outserial"+a).prop("disabled",!1),$("#outrow"+a).hide(),$(this).val("Add Item"),r--});
$(document).on("click",".replacement",function(){$("#outOptionModal .close").click();$("#replacementModal").modal({backdrop:"static",keyboard:!1})});
$(document).on("click",".replacement_next_Btn",function(){if($("#replacementcustomer-id").val()){var a=$("#replacementcustomer-id").val();$("#replacementModal .closes").click();$("table.replacementDetails").dataTable().fnDestroy();replaceTable=$("table.replacementDetails").DataTable({dom:"lrtip",language:{emptyTable:" "},processing:!0,serverSide:!0,ajax:"/pull-details/"+a,columns:[{data:"date",name:"date"},{data:"category",name:"category"},{data:"items_id",name:"items_id"},{data:"item",name:"item"},
{data:"serial",name:"serial"}]});$("#replacementTableModal").modal({backdrop:"static",keyboard:!1});$("#replacecustomer").val($("#replacementcustomer").val());$("#replaceclient").val($("#replacementclient").val())}});
$(document).on("click","#replacementDetails tr",function(){$("#replacementDetails tbody tr:eq(0)").data();var a=replaceTable.row(this).data(),b=a.category_id,e=a.id;repdata=a.id;var d=" ";console.log(a.id);$("#replacementTableModal .closes").click();$("#replaceselectcustomer").val($("#replacementcustomer").val());$("#replaceselectclient").val($("#replacementclient").val());$("table.replacement1Details").DataTable({dom:"rt",language:{emptyTable:" "},processing:!0,serverSide:!0,ajax:"/pull-details1/"+
e,columnDefs:[{className:"dt-center",targets:"_all"}],columns:[{data:"date",name:"date"},{data:"category",name:"category"},{data:"items_id",name:"items_id"},{data:"item",name:"item"},{data:"serial",name:"serial"}]});$("#replacementSelectModal").modal({backdrop:"static",keyboard:!1});$.ajax({type:"get",url:"itemcode",data:{id:b},success:function(c){d+='<option selected value="select" disabled>select description</option>';for(var f=0;f<c.length;f++)d+='<option value="'+c[f].id+'">'+c[f].item.toUpperCase()+
"</option>";$("#repdesc1").find("option").remove().end().append(d)}})});$(document).on("change","#repdesc1",function(){var a=$(this).val(),b=" ";$.ajax({type:"get",url:"getserials",data:{id:a},async:!1,success:function(e){b+='<option selected value="select" disabled>select serial</option>';for(var d=0;d<e.length;d++)b+='<option value="'+e[d].id+'">'+e[d].serial+"</option>";$("#repserial1").find("option").remove().end().append(b)}})});
$(document).on("click",".rep_sub_Btn",function(){if($("#repserial1").val()){var a=$("#repserial1").val(),b=$("#replacementcustomer-id").val();$.ajax({url:"rep-update",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"json",type:"PUT",async:!1,data:{item:a,repdata:repdata,custid:b},success:function(e){window.location.href="stocks"},error:function(e,d,c){alert(e.responseText)}})}});
$(document).on("keyup","#replacementclient",function(){var a=$(this).val(),b=" ";$("#replacementcustomer").val("");$("#replacementcustomer-name").find("option").remove();(function(e){$.ajax({type:"get",url:"pclient-autocomplete",data:{id:a},success:function(d){b+=" ";for(var c=0;c<d.length;c++)b+='<option data-value="'+d[c].customer_id+'" value="'+d[c].customer.toUpperCase()+'"></option>';$("#replacementclient-name").find("option").remove().end().append(b);$("#replacementclient-id").val($('#replacementclient-name [value="'+
$("#replacementclient").val()+'"]').data("value"))}})})(replacementclient)});
$(document).on("keyup","#replacementcustomer",function(){var a=$(this).val(),b=" ";if($("#replacementclient-id").val())var e=$("#replacementclient-id").val();else return alert("Incomplete Client Name!!!!"),!1;(function(d){$.ajax({type:"get",url:"pcustomer-autocomplete",async:!1,data:{id:a,client:e},success:function(c){b+=" ";for(var f=0;f<c.length;f++)b+='<option data-value="'+c[f].customer_branch_id+'" value="'+c[f].customer_branch.toUpperCase()+'"></option>';$("#replacementcustomer-name").find("option").remove().end().append(b);
$("#replacementcustomer-id").val($('#replacementcustomer-name [value="'+$("#replacementcustomer").val()+'"]').data("value"))}})})(replacementcustomer)});